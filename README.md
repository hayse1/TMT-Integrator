# Introduction
TMT-Integrator extracts and combines channel abundances from multiple TMT samples. It takes PSM tables generated by [Philospher](https://philosopher.nesvilab.org/) (via [FragPipe](http://fragpipe.nesvilab.org/)) as input, and creates a general report at the specified level (gene, protein, peptide, and modified site). TMT-Integrator can be run through [FragPipe](http://fragpipe.nesvilab.org/) or in the command line (see below).

# Methods/Workflow (Input/Output)

There are five steps in TMT-Integrator, including (1) best PSM selection, (2) log transformation and normalization, (3) PSM-level normalization, (4) outlier removal, and (5) protein level normalization.

## Best PSM selection

For high-quality quantification, we only include PSMs that meet the following criteria:

* TMT-labeled
* Reference TMT channel intensity > 0
* Precursor ion purity >= 50%
* Summed (across all 10 channels) MS2 intensity >= 5% (2.5% for PHOSPHO)
* Best (highest summed MS2 intensity) PSM only among all PSMs identifying the same peptide ion in the same sample/fraction (i.e. same LC-MS/MS run)
* PSMs not mapping (as unique or razor peptides) to contaminant proteins
* PSMs with phosphorylation (only for phospho data)


## Log transform and normalization
For each selected PSM, the 10 channel intensities are log2 transformed and then subtracted from the reference channel.   


## PSM level normalization
For a PSM table, the selected PSMs are sorted and divided into 10 groups on the basis of their retention time. Then, we subtract the channel ratios from the median channel ratios of each PSM group.


## Outlier removal
Interquartile range (IQR) algorithm: We compute the first quantile (Q1), the third quantile (Q3) and the interquartile range (IQR; Q3-Q1) in each PSM group and remove PSM with ratios outside of the boundaries of Q1-1.5xIQR and Q3+1.5xIQR.


## Protein level normalization
There are two protein level normalization methods in TMT-Integrator. The first method is called MD which we calculate the median log2 ratio of the ith sample (m0) and center the ratios in a sample by subtracting m0 from each ratio. The second method is called GN which, in addition to MD, we calculate the median deviation and median absolute deviation of centered values (m1 and m2), and scale all values to derive the final measure using the equation: yij''=(yijâ€™/m2)xm1+m0, where yij is the log2 ratio in the ith group of the jth sample.                                                                           


# How to Download
Download the latest version [here](https://github.com/Nesvilab/TMT-Integrator/releases/latest) for command line use, or download [FragPipe](http://fragpipe.nesvilab.org/).


# Commands
`java -jar TMTIntegrator.jar TMTIntegrator.yaml PSM_Tables`

`java -jar -Xmx16g TMTIntegrator.jar TMTIntegrator.yaml /*_psm.tsv`
